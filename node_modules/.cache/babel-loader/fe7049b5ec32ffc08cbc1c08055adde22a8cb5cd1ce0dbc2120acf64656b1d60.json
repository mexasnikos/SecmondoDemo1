{"ast":null,"code":"var _TerracottaService;\n/**\n * Terracotta Insurance Quote Integration Service\n * \n * This service handles all communication with the Terracotta Integrated Quote web service\n * using SOAP protocol. It provides methods for:\n * - Requesting quotes (ProvideQuotation)\n * - Updating quotes with additional covers (ProvideQuotationWithAlterations)\n * - Getting screening questions (ScreeningQuestions)\n * - Saving policy details (SavePolicyDetails)\n */\n\n// Terracotta API Configuration\nconst TERRACOTTA_BASE_URL = 'https://www.asuaonline.com/ws/integratedquote.asmx';\nconst TERRACOTTA_USER_ID = '4072';\nconst TERRACOTTA_USER_CODE = '111427';\n\n// TypeScript interfaces for Terracotta API data structures\n\n/**\n * SOAP XML Builder utility functions\n */\nclass SOAPBuilder {\n  static createEnvelope(body) {\n    return `<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" \n               xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" \n               xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\">\n  <soap:Body>\n    ${body}\n  </soap:Body>\n</soap:Envelope>`;\n  }\n  static buildTravelerXML(traveler) {\n    return `\n      <Travellers>\n        <TravellerNumber>${traveler.TravellerNumber}</TravellerNumber>\n        <Title>${traveler.Title}</Title>\n        <FirstName>${traveler.FirstName}</FirstName>\n        <LastName>${traveler.LastName}</LastName>\n        <DateOfBirth>${traveler.DateOfBirth}</DateOfBirth>\n        <Age>${traveler.Age}</Age>\n        ${traveler.AgebandID ? `<AgebandID>${traveler.AgebandID}</AgebandID>` : ''}\n        ${traveler.TitleID ? `<TitleID>${traveler.TitleID}</TitleID>` : ''}\n        ${traveler.minAge ? `<minAge>${traveler.minAge}</minAge>` : ''}\n        ${traveler.maxAge ? `<maxAge>${traveler.maxAge}</maxAge>` : ''}\n        ${traveler.AlterationID ? `<AlterationID>${traveler.AlterationID}</AlterationID>` : ''}\n        ${traveler.msPrice ? `<msPrice>${traveler.msPrice}</msPrice>` : ''}\n        ${traveler.msPriceExcIPT ? `<msPriceExcIPT>${traveler.msPriceExcIPT}</msPriceExcIPT>` : ''}\n        ${traveler.msConditions ? `<msConditions>${traveler.msConditions}</msConditions>` : ''}\n        ${traveler.ScreeningInformation ? `<ScreeningInformation>${traveler.ScreeningInformation}</ScreeningInformation>` : '<ScreeningInformation xsi:nil=\"true\" />'}\n      </Travellers>`;\n  }\n  static buildContactDetailsXML(contact) {\n    return `\n      <ContactDetails>\n        <Address>${contact.Address}</Address>\n        <Postcode>${contact.Postcode}</Postcode>\n        <Email>${contact.Email}</Email>\n        <Telephone>${contact.Telephone}</Telephone>\n        ${contact.VehicleMakeModel ? `<VehicleMakeModel>${contact.VehicleMakeModel}</VehicleMakeModel>` : ''}\n        ${contact.VehicleLicensePlate ? `<VehicleLicensePlate>${contact.VehicleLicensePlate}</VehicleLicensePlate>` : ''}\n        ${contact.VehicleYearManufacture ? `<VehicleYearManufacture>${contact.VehicleYearManufacture}</VehicleYearManufacture>` : ''}\n      </ContactDetails>`;\n  }\n  static buildQuoteDetailsXML(details) {\n    const travelersXML = details.Travellers.map(traveler => this.buildTravelerXML(traveler)).join('');\n    const contactXML = this.buildContactDetailsXML(details.ContactDetails);\n    return `\n      <quoteDetails>\n        <ResidenceID>${parseInt(details.ResidenceID) || 1}</ResidenceID>\n        <TypePolicyID>${details.TypePolicyID}</TypePolicyID>\n        <TypePackageID>${parseInt(details.TypePackageID) || 1}</TypePackageID>\n        <Destination>${details.Destination}</Destination>\n        <StartDate>${details.StartDate}</StartDate>\n        <EndDate>${details.EndDate}</EndDate>\n        ${travelersXML}\n        ${contactXML}\n        ${details.includeAnnualQuotes !== undefined ? `<includeAnnualQuotes>${details.includeAnnualQuotes}</includeAnnualQuotes>` : ''}\n        ${details.includeUpsell !== undefined ? `<includeUpsell>${details.includeUpsell}</includeUpsell>` : ''}\n        ${details.alterionGenericID ? `<alterionGenericID>${details.alterionGenericID}</alterionGenericID>` : ''}\n        ${details.voucherCode ? `<voucherCode>${details.voucherCode}</voucherCode>` : ''}\n        ${details.isCYTI !== undefined ? `<isCYTI>${details.isCYTI}</isCYTI>` : ''}\n        ${details.currencyID ? `<currencyID>${details.currencyID}</currencyID>` : ''}\n        ${details.groupPerProduct !== undefined ? `<groupPerProduct>${details.groupPerProduct}</groupPerProduct>` : ''}\n        ${details.priceOrder ? `<priceOrder>${details.priceOrder}</priceOrder>` : ''}\n        ${details.schemaIDFilter ? `<schemaIDFilter>${details.schemaIDFilter}</schemaIDFilter>` : ''}\n        ${details.useCoverLevelUpsell !== undefined ? `<useCoverLevelUpsell>${details.useCoverLevelUpsell}</useCoverLevelUpsell>` : ''}\n        ${details.sellOnBehalfOf ? `<sellOnBehalfOf>${details.sellOnBehalfOf}</sellOnBehalfOf>` : ''}\n        ${details.customerUniqueID ? `<customerUniqueID>${details.customerUniqueID}</customerUniqueID>` : ''}\n        ${details.quoteVisitAuditID ? `<quoteVisitAuditID>${details.quoteVisitAuditID}</quoteVisitAuditID>` : ''}\n      </quoteDetails>`;\n  }\n  static buildScreeningAnswersXML(answers) {\n    return '<screeningQuestionAnswers>' + answers.map(answer => `\n        <screeningQuestionAnswer>\n          <questionNumber>${answer.questionNumber}</questionNumber>\n          <answer>${answer.answer}</answer>\n        </screeningQuestionAnswer>`).join('') + '</screeningQuestionAnswers>';\n  }\n}\n\n/**\n * XML Parser utility functions\n */\nclass XMLParser {\n  static parseQuoteResponse(xmlText) {\n    try {\n      var _xmlDoc$querySelector;\n      const parser = new DOMParser();\n      const xmlDoc = parser.parseFromString(xmlText, 'text/xml');\n\n      // Check for parsing errors\n      const parseError = xmlDoc.querySelector('parsererror');\n      if (parseError) {\n        throw new Error(`XML parsing error: ${parseError.textContent}`);\n      }\n      const message = ((_xmlDoc$querySelector = xmlDoc.querySelector('Message')) === null || _xmlDoc$querySelector === void 0 ? void 0 : _xmlDoc$querySelector.textContent) || '';\n      const quoteResults = [];\n      const quoteResultNodes = xmlDoc.querySelectorAll('quoteResults');\n      quoteResultNodes.forEach(node => {\n        var _node$querySelector, _node$querySelector2, _node$querySelector3, _node$querySelector4, _node$querySelector5, _node$querySelector6, _node$querySelector7, _node$querySelector8;\n        const result = {\n          QuoteID: ((_node$querySelector = node.querySelector('QuoteID')) === null || _node$querySelector === void 0 ? void 0 : _node$querySelector.textContent) || '',\n          schemaName: ((_node$querySelector2 = node.querySelector('schemaName')) === null || _node$querySelector2 === void 0 ? void 0 : _node$querySelector2.textContent) || '',\n          policyTypeName: ((_node$querySelector3 = node.querySelector('policyTypeName')) === null || _node$querySelector3 === void 0 ? void 0 : _node$querySelector3.textContent) || '',\n          SI: ((_node$querySelector4 = node.querySelector('SI')) === null || _node$querySelector4 === void 0 ? void 0 : _node$querySelector4.textContent) || '',\n          PW: ((_node$querySelector5 = node.querySelector('PW')) === null || _node$querySelector5 === void 0 ? void 0 : _node$querySelector5.textContent) || '',\n          Currency: ((_node$querySelector6 = node.querySelector('Currency')) === null || _node$querySelector6 === void 0 ? void 0 : _node$querySelector6.textContent) || '',\n          IPT: parseFloat(((_node$querySelector7 = node.querySelector('IPT')) === null || _node$querySelector7 === void 0 ? void 0 : _node$querySelector7.textContent) || '0'),\n          GrossPrice: parseFloat(((_node$querySelector8 = node.querySelector('GrossPrice')) === null || _node$querySelector8 === void 0 ? void 0 : _node$querySelector8.textContent) || '0')\n        };\n        quoteResults.push(result);\n      });\n      return {\n        Message: message,\n        quoteResults\n      };\n    } catch (error) {\n      console.error('Error parsing quote response:', error);\n      throw new Error(`Failed to parse quote response: ${error instanceof Error ? error.message : 'Unknown error'}`);\n    }\n  }\n  static parseScreeningQuestionsResponse(xmlText) {\n    try {\n      var _xmlDoc$querySelector2;\n      const parser = new DOMParser();\n      const xmlDoc = parser.parseFromString(xmlText, 'text/xml');\n      const parseError = xmlDoc.querySelector('parsererror');\n      if (parseError) {\n        throw new Error(`XML parsing error: ${parseError.textContent}`);\n      }\n      const message = ((_xmlDoc$querySelector2 = xmlDoc.querySelector('Message')) === null || _xmlDoc$querySelector2 === void 0 ? void 0 : _xmlDoc$querySelector2.textContent) || '';\n      const screeningQuestions = [];\n      const questionNodes = xmlDoc.querySelectorAll('screeningQuestion');\n      questionNodes.forEach(node => {\n        var _node$querySelector9, _node$querySelector0, _node$querySelector1, _node$querySelector10, _node$querySelector11, _node$querySelector12, _node$querySelector13, _node$querySelector14;\n        const question = {\n          questionNumber: parseInt(((_node$querySelector9 = node.querySelector('questionNumber')) === null || _node$querySelector9 === void 0 ? void 0 : _node$querySelector9.textContent) || '0'),\n          question: ((_node$querySelector0 = node.querySelector('question')) === null || _node$querySelector0 === void 0 ? void 0 : _node$querySelector0.textContent) || '',\n          yesMessage: ((_node$querySelector1 = node.querySelector('yesMessage')) === null || _node$querySelector1 === void 0 ? void 0 : _node$querySelector1.textContent) || '',\n          noMessage: ((_node$querySelector10 = node.querySelector('noMessage')) === null || _node$querySelector10 === void 0 ? void 0 : _node$querySelector10.textContent) || '',\n          yesAction: ((_node$querySelector11 = node.querySelector('yesAction')) === null || _node$querySelector11 === void 0 ? void 0 : _node$querySelector11.textContent) || '',\n          noAction: ((_node$querySelector12 = node.querySelector('noAction')) === null || _node$querySelector12 === void 0 ? void 0 : _node$querySelector12.textContent) || '',\n          yesActionText: ((_node$querySelector13 = node.querySelector('yesActionText')) === null || _node$querySelector13 === void 0 ? void 0 : _node$querySelector13.textContent) || '',\n          noActionText: ((_node$querySelector14 = node.querySelector('noActionText')) === null || _node$querySelector14 === void 0 ? void 0 : _node$querySelector14.textContent) || ''\n        };\n        screeningQuestions.push(question);\n      });\n      return {\n        Message: message,\n        screeningQuestions\n      };\n    } catch (error) {\n      console.error('Error parsing screening questions response:', error);\n      throw new Error(`Failed to parse screening questions response: ${error instanceof Error ? error.message : 'Unknown error'}`);\n    }\n  }\n  static parseSavePolicyResponse(xmlText) {\n    try {\n      var _xmlDoc$querySelector3, _xmlDoc$querySelector4, _xmlDoc$querySelector5, _xmlDoc$querySelector6, _xmlDoc$querySelector7, _xmlDoc$querySelector8;\n      const parser = new DOMParser();\n      const xmlDoc = parser.parseFromString(xmlText, 'text/xml');\n      const parseError = xmlDoc.querySelector('parsererror');\n      if (parseError) {\n        throw new Error(`XML parsing error: ${parseError.textContent}`);\n      }\n      return {\n        Message: ((_xmlDoc$querySelector3 = xmlDoc.querySelector('Message')) === null || _xmlDoc$querySelector3 === void 0 ? void 0 : _xmlDoc$querySelector3.textContent) || '',\n        policySaved: ((_xmlDoc$querySelector4 = xmlDoc.querySelector('policySaved')) === null || _xmlDoc$querySelector4 === void 0 ? void 0 : _xmlDoc$querySelector4.textContent) || 'No',\n        policyID: ((_xmlDoc$querySelector5 = xmlDoc.querySelector('policyID')) === null || _xmlDoc$querySelector5 === void 0 ? void 0 : _xmlDoc$querySelector5.textContent) || '',\n        certificate: ((_xmlDoc$querySelector6 = xmlDoc.querySelector('certificate')) === null || _xmlDoc$querySelector6 === void 0 ? void 0 : _xmlDoc$querySelector6.textContent) || '',\n        PW: ((_xmlDoc$querySelector7 = xmlDoc.querySelector('PW')) === null || _xmlDoc$querySelector7 === void 0 ? void 0 : _xmlDoc$querySelector7.textContent) || '',\n        SI: ((_xmlDoc$querySelector8 = xmlDoc.querySelector('SI')) === null || _xmlDoc$querySelector8 === void 0 ? void 0 : _xmlDoc$querySelector8.textContent) || ''\n      };\n    } catch (error) {\n      console.error('Error parsing save policy response:', error);\n      throw new Error(`Failed to parse save policy response: ${error instanceof Error ? error.message : 'Unknown error'}`);\n    }\n  }\n  static parseProductListResponse(xmlText) {\n    try {\n      var _xmlDoc$querySelector9, _xmlDoc$querySelector0;\n      const parser = new DOMParser();\n      const xmlDoc = parser.parseFromString(xmlText, 'text/xml');\n      const parseError = xmlDoc.querySelector('parsererror');\n      if (parseError) {\n        throw new Error(`XML parsing error: ${parseError.textContent}`);\n      }\n      const message = ((_xmlDoc$querySelector9 = xmlDoc.querySelector('message')) === null || _xmlDoc$querySelector9 === void 0 ? void 0 : _xmlDoc$querySelector9.textContent) || '';\n      const resultID = parseInt(((_xmlDoc$querySelector0 = xmlDoc.querySelector('errorID')) === null || _xmlDoc$querySelector0 === void 0 ? void 0 : _xmlDoc$querySelector0.textContent) || '0');\n      const schemas = [];\n      const schemaNodes = xmlDoc.querySelectorAll('Schema');\n      schemaNodes.forEach(node => {\n        var _node$querySelector15, _node$querySelector16;\n        const schema = {\n          SchemaID: parseInt(((_node$querySelector15 = node.querySelector('SchemaID')) === null || _node$querySelector15 === void 0 ? void 0 : _node$querySelector15.textContent) || '0'),\n          SchemaName: ((_node$querySelector16 = node.querySelector('SchemaName')) === null || _node$querySelector16 === void 0 ? void 0 : _node$querySelector16.textContent) || ''\n        };\n        schemas.push(schema);\n      });\n      return {\n        Message: message,\n        ResultID: resultID,\n        Schemas: schemas\n      };\n    } catch (error) {\n      console.error('Error parsing product list response:', error);\n      throw new Error(`Failed to parse product list response: ${error instanceof Error ? error.message : 'Unknown error'}`);\n    }\n  }\n}\n\n/**\n * Main Terracotta Service Class\n */\nexport class TerracottaService {\n  constructor(userID = TERRACOTTA_USER_ID, userCode = TERRACOTTA_USER_CODE) {\n    this.userID = void 0;\n    this.userCode = void 0;\n    this.userID = userID;\n    this.userCode = userCode;\n  }\n  static getInstance(userID, userCode) {\n    if (!TerracottaService.instance) {\n      TerracottaService.instance = new TerracottaService(userID, userCode);\n    }\n    return TerracottaService.instance;\n  }\n\n  /**\n   * Generic SOAP request method\n   */\n  async makeSOAPRequest(method, requestBody) {\n    const soapEnvelope = SOAPBuilder.createEnvelope(requestBody);\n    console.log('Making SOAP request to:', TERRACOTTA_BASE_URL);\n    console.log('SOAP Envelope:', soapEnvelope);\n    const response = await fetch(TERRACOTTA_BASE_URL, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'text/xml; charset=utf-8',\n        'SOAPAction': `WS-IntegratedQuote/${method}`\n      },\n      body: soapEnvelope\n    });\n    console.log('SOAP Response Status:', response.status, response.statusText);\n    const responseText = await response.text();\n    console.log('SOAP Response Body:', responseText);\n    if (!response.ok) {\n      throw new Error(`SOAP request failed: ${response.status} ${response.statusText}`);\n    }\n    return responseText;\n  }\n\n  /**\n   * Test connection with HelloWorld method\n   */\n  async testConnection() {\n    try {\n      const soapBody = `\n        <HelloWorld xmlns=\"WS-IntegratedQuote\">\n        </HelloWorld>`;\n      const responseText = await this.makeSOAPRequest('HelloWorld', soapBody);\n      console.log('Connection test successful:', responseText);\n      return true;\n    } catch (error) {\n      console.error('Connection test failed:', error);\n      return false;\n    }\n  }\n\n  /**\n   * Get available products for the user\n   */\n  async getUserProductList() {\n    try {\n      const soapBody = `\n        <GetUserProductList xmlns=\"WS-IntegratedQuote\">\n          <userID>${parseInt(this.userID)}</userID>\n          <userCode>${parseInt(this.userCode)}</userCode>\n        </GetUserProductList>`;\n      const responseText = await this.makeSOAPRequest('GetUserProductList', soapBody);\n      return XMLParser.parseProductListResponse(responseText);\n    } catch (error) {\n      console.error('Error in getUserProductList:', error);\n      throw new Error(`Failed to get user product list: ${error instanceof Error ? error.message : 'Unknown error'}`);\n    }\n  }\n\n  /**\n   * 1. Request for quotations\n   * Calls the ProvideQuotation method to obtain a list of possible quotes\n   */\n  async provideQuotation(request) {\n    try {\n      const quoteDetailsXML = SOAPBuilder.buildQuoteDetailsXML(request.quoteDetails);\n      const soapBody = `\n        <ProvideQuotation xmlns=\"WS-IntegratedQuote\">\n          <userID>${parseInt(request.userID)}</userID>\n          <userCode>${parseInt(request.userCode)}</userCode>\n          ${quoteDetailsXML}\n        </ProvideQuotation>`;\n      const responseText = await this.makeSOAPRequest('ProvideQuotation', soapBody);\n      return XMLParser.parseQuoteResponse(responseText);\n    } catch (error) {\n      console.error('Error in provideQuotation:', error);\n      throw new Error(`Failed to get quotes from Terracotta: ${error instanceof Error ? error.message : 'Unknown error'}`);\n    }\n  }\n\n  /**\n   * 3. Obtain Screening Questions\n   * Calls ScreeningQuestions to get screening questions for the selected quote\n   */\n  async getScreeningQuestions(quoteID) {\n    try {\n      const soapBody = `\n        <ScreeningQuestions xmlns=\"WS-IntegratedQuote\">\n          <userID>${parseInt(this.userID)}</userID>\n          <userCode>${parseInt(this.userCode)}</userCode>\n          <quoteID>${quoteID}</quoteID>\n        </ScreeningQuestions>`;\n      const responseText = await this.makeSOAPRequest('ScreeningQuestions', soapBody);\n      return XMLParser.parseScreeningQuestionsResponse(responseText);\n    } catch (error) {\n      console.error('Error in getScreeningQuestions:', error);\n      throw new Error(`Failed to get screening questions: ${error instanceof Error ? error.message : 'Unknown error'}`);\n    }\n  }\n\n  /**\n   * 4. Save a quote as a Live policy\n   * Calls SavePolicyDetails to convert the quote into a live policy\n   */\n  async savePolicyDetails(request) {\n    try {\n      const screeningAnswersXML = SOAPBuilder.buildScreeningAnswersXML(request.screeningQuestionAnswers);\n      const soapBody = `\n        <SavePolicyDetails xmlns=\"WS-IntegratedQuote\">\n          <userID>${parseInt(request.userID)}</userID>\n          <userCode>${parseInt(request.userCode)}</userCode>\n          <quoteID>${request.quoteID}</quoteID>\n          ${screeningAnswersXML}\n          ${request.medicalScreeningReference ? `<medicalScreeningReference>${request.medicalScreeningReference}</medicalScreeningReference>` : ''}\n        </SavePolicyDetails>`;\n      const responseText = await this.makeSOAPRequest('SavePolicyDetails', soapBody);\n      return XMLParser.parseSavePolicyResponse(responseText);\n    } catch (error) {\n      console.error('Error in savePolicyDetails:', error);\n      throw new Error(`Failed to save policy details: ${error instanceof Error ? error.message : 'Unknown error'}`);\n    }\n  }\n\n  /**\n   * Utility method to convert frontend data to Terracotta format\n   */\n  static convertToTerracottaFormat(formData) {\n    var _formData$billingAddr, _formData$contactAddr, _formData$billingAddr2, _formData$contactAddr2, _formData$travelers$, _formData$travelers$2;\n    console.log('Converting form data to Terracotta format:', formData);\n\n    // Convert travelers to Terracotta format using actual user data\n    const travelers = formData.travelers.map((traveler, index) => {\n      // Prioritize date of birth over age for accuracy\n      const dateOfBirth = traveler.dateOfBirth || calculateDateOfBirth(parseInt(traveler.age));\n      const calculatedAge = traveler.dateOfBirth ? calculateAgeFromDateOfBirth(traveler.dateOfBirth) : parseInt(traveler.age);\n      console.log(`Traveler ${index + 1}: DOB=${dateOfBirth}, Age=${calculatedAge}`);\n      return {\n        TravellerNumber: index + 1,\n        Title: traveler.title || 'Mr',\n        // Use actual title from form\n        FirstName: traveler.firstName,\n        LastName: traveler.lastName,\n        DateOfBirth: formatDateForTerracotta(dateOfBirth),\n        Age: calculatedAge,\n        AgebandID: getAgebandID(calculatedAge),\n        TitleID: getTitleID(traveler.title || 'Mr'),\n        minAge: calculatedAge,\n        maxAge: calculatedAge,\n        ScreeningInformation: null\n      };\n    });\n\n    // Convert contact details using actual user data\n    const contactDetails = {\n      Address: ((_formData$billingAddr = formData.billingAddress) === null || _formData$billingAddr === void 0 ? void 0 : _formData$billingAddr.street) || ((_formData$contactAddr = formData.contactAddress) === null || _formData$contactAddr === void 0 ? void 0 : _formData$contactAddr.street) || '123 Main Street',\n      Postcode: ((_formData$billingAddr2 = formData.billingAddress) === null || _formData$billingAddr2 === void 0 ? void 0 : _formData$billingAddr2.postalCode) || ((_formData$contactAddr2 = formData.contactAddress) === null || _formData$contactAddr2 === void 0 ? void 0 : _formData$contactAddr2.postalCode) || '12345',\n      Email: ((_formData$travelers$ = formData.travelers[0]) === null || _formData$travelers$ === void 0 ? void 0 : _formData$travelers$.email) || formData.contactEmail || 'test@example.com',\n      Telephone: ((_formData$travelers$2 = formData.travelers[0]) === null || _formData$travelers$2 === void 0 ? void 0 : _formData$travelers$2.phone) || formData.contactPhone || '+30123456789',\n      VehicleMakeModel: formData.vehicleMakeModel,\n      VehicleLicensePlate: formData.vehicleLicensePlate,\n      VehicleYearManufacture: formData.vehicleYearManufacture\n    };\n\n    // Convert trip details using actual user data\n    const quoteDetails = {\n      ResidenceID: getResidenceID(formData.countryOfResidence),\n      TypePolicyID: getTypePolicyID(formData.tripType),\n      TypePackageID: getTypePackageID(formData.tripType),\n      Destination: formData.destination || 'Europe',\n      StartDate: formatDateForTerracotta(formData.startDate),\n      EndDate: formatDateForTerracotta(formData.endDate),\n      Travellers: travelers,\n      ContactDetails: contactDetails,\n      includeAnnualQuotes: formData.tripType === 'annual' ? 1 : 0,\n      includeUpsell: 1,\n      // Include upsell options\n      voucherCode: formData.voucherCode,\n      currencyID: getCurrencyID(formData.currency || 'EUR'),\n      groupPerProduct: false,\n      priceOrder: 1,\n      // Sort by price ascending\n      useCoverLevelUpsell: true,\n      customerUniqueID: formData.customerId ? parseInt(formData.customerId) : undefined,\n      quoteVisitAuditID: Date.now(),\n      // Use timestamp as audit ID\n      schemaIDFilter: '683,717' // Use your available SchemaIDs\n    };\n    console.log('Converted Terracotta request:', quoteDetails);\n    return {\n      userID: TERRACOTTA_USER_ID,\n      userCode: TERRACOTTA_USER_CODE,\n      quoteDetails\n    };\n  }\n}\n\n/**\n * Utility functions for data conversion\n */\n_TerracottaService = TerracottaService;\nTerracottaService.instance = void 0;\nfunction formatDateForTerracotta(dateString) {\n  if (!dateString) return '';\n  // Convert from YYYY-MM-DD to YYYY/MM/DD\n  return dateString.replace(/-/g, '/');\n}\nfunction calculateDateOfBirth(age) {\n  const currentYear = new Date().getFullYear();\n  const birthYear = currentYear - age;\n  // Use January 1st as default date\n  return `${birthYear}/01/01`;\n}\nfunction calculateAgeFromDateOfBirth(dateOfBirth) {\n  const birthDate = new Date(dateOfBirth);\n  const today = new Date();\n  let age = today.getFullYear() - birthDate.getFullYear();\n  const monthDiff = today.getMonth() - birthDate.getMonth();\n  if (monthDiff < 0 || monthDiff === 0 && today.getDate() < birthDate.getDate()) {\n    age--;\n  }\n  return Math.max(0, age);\n}\nfunction getResidenceID(country) {\n  // Map countries to Terracotta Residence IDs\n  // Based on your account, we'll use numeric IDs that should work\n  const residenceMap = {\n    'Greece': '1',\n    // Default for Greece\n    'Germany': '2',\n    'United Kingdom': '3',\n    'France': '4',\n    'Italy': '5',\n    'Spain': '6',\n    'Netherlands': '7',\n    'Belgium': '8',\n    'Austria': '9',\n    'Switzerland': '10',\n    'United States': '11',\n    'Canada': '12',\n    'Australia': '13'\n  };\n  return residenceMap[country] || '1'; // Default to 1\n}\nfunction getTypePolicyID(tripType) {\n  // Use your available SchemaIDs for policy types\n  // SchemaID 683: \"Already Travelling Travel Insurance 2023-2024\"\n  // SchemaID 717: \"KTRM Travel Insurance 2025\"\n  const policyMap = {\n    'single': '683',\n    // Use your available SchemaID\n    'annual': '717',\n    // Use your other available SchemaID\n    'comprehensive': '683' // Use available SchemaID\n  };\n  return policyMap[tripType] || '683'; // Default to your first SchemaID\n}\nfunction getTypePackageID(tripType) {\n  // Use your available SchemaIDs for package types\n  const packageMap = {\n    'single': '683',\n    // Use your available SchemaID\n    'annual': '717',\n    // Use your other available SchemaID\n    'comprehensive': '683' // Use available SchemaID\n  };\n  return packageMap[tripType] || '683'; // Default to your first SchemaID\n}\nfunction getAgebandID(age) {\n  // Map age to Terracotta Ageband ID\n  if (age <= 17) return 1;\n  if (age <= 30) return 2;\n  if (age <= 40) return 3;\n  if (age <= 50) return 4;\n  if (age <= 60) return 5;\n  if (age <= 70) return 6;\n  return 7; // 70+\n}\nfunction getTitleID(title) {\n  // Map title to Terracotta Title ID\n  const titleMap = {\n    'Mr': 1,\n    'Mrs': 2,\n    'Miss': 3,\n    'Ms': 4,\n    'Dr': 5,\n    'Prof': 6\n  };\n  return titleMap[title] || 1; // Default to Mr\n}\nfunction getCurrencyID(currency) {\n  // Map currency to Terracotta Currency ID\n  const currencyMap = {\n    'EUR': 1,\n    'USD': 2,\n    'GBP': 3,\n    'CHF': 4\n  };\n  return currencyMap[currency] || 1; // Default to EUR\n}\nexport default TerracottaService;","map":{"version":3,"names":["TERRACOTTA_BASE_URL","TERRACOTTA_USER_ID","TERRACOTTA_USER_CODE","SOAPBuilder","createEnvelope","body","buildTravelerXML","traveler","TravellerNumber","Title","FirstName","LastName","DateOfBirth","Age","AgebandID","TitleID","minAge","maxAge","AlterationID","msPrice","msPriceExcIPT","msConditions","ScreeningInformation","buildContactDetailsXML","contact","Address","Postcode","Email","Telephone","VehicleMakeModel","VehicleLicensePlate","VehicleYearManufacture","buildQuoteDetailsXML","details","travelersXML","Travellers","map","join","contactXML","ContactDetails","parseInt","ResidenceID","TypePolicyID","TypePackageID","Destination","StartDate","EndDate","includeAnnualQuotes","undefined","includeUpsell","alterionGenericID","voucherCode","isCYTI","currencyID","groupPerProduct","priceOrder","schemaIDFilter","useCoverLevelUpsell","sellOnBehalfOf","customerUniqueID","quoteVisitAuditID","buildScreeningAnswersXML","answers","answer","questionNumber","XMLParser","parseQuoteResponse","xmlText","_xmlDoc$querySelector","parser","DOMParser","xmlDoc","parseFromString","parseError","querySelector","Error","textContent","message","quoteResults","quoteResultNodes","querySelectorAll","forEach","node","_node$querySelector","_node$querySelector2","_node$querySelector3","_node$querySelector4","_node$querySelector5","_node$querySelector6","_node$querySelector7","_node$querySelector8","result","QuoteID","schemaName","policyTypeName","SI","PW","Currency","IPT","parseFloat","GrossPrice","push","Message","error","console","parseScreeningQuestionsResponse","_xmlDoc$querySelector2","screeningQuestions","questionNodes","_node$querySelector9","_node$querySelector0","_node$querySelector1","_node$querySelector10","_node$querySelector11","_node$querySelector12","_node$querySelector13","_node$querySelector14","question","yesMessage","noMessage","yesAction","noAction","yesActionText","noActionText","parseSavePolicyResponse","_xmlDoc$querySelector3","_xmlDoc$querySelector4","_xmlDoc$querySelector5","_xmlDoc$querySelector6","_xmlDoc$querySelector7","_xmlDoc$querySelector8","policySaved","policyID","certificate","parseProductListResponse","_xmlDoc$querySelector9","_xmlDoc$querySelector0","resultID","schemas","schemaNodes","_node$querySelector15","_node$querySelector16","schema","SchemaID","SchemaName","ResultID","Schemas","TerracottaService","constructor","userID","userCode","getInstance","instance","makeSOAPRequest","method","requestBody","soapEnvelope","log","response","fetch","headers","status","statusText","responseText","text","ok","testConnection","soapBody","getUserProductList","provideQuotation","request","quoteDetailsXML","quoteDetails","getScreeningQuestions","quoteID","savePolicyDetails","screeningAnswersXML","screeningQuestionAnswers","medicalScreeningReference","convertToTerracottaFormat","formData","_formData$billingAddr","_formData$contactAddr","_formData$billingAddr2","_formData$contactAddr2","_formData$travelers$","_formData$travelers$2","travelers","index","dateOfBirth","calculateDateOfBirth","age","calculatedAge","calculateAgeFromDateOfBirth","title","firstName","lastName","formatDateForTerracotta","getAgebandID","getTitleID","contactDetails","billingAddress","street","contactAddress","postalCode","email","contactEmail","phone","contactPhone","vehicleMakeModel","vehicleLicensePlate","vehicleYearManufacture","getResidenceID","countryOfResidence","getTypePolicyID","tripType","getTypePackageID","destination","startDate","endDate","getCurrencyID","currency","customerId","Date","now","_TerracottaService","dateString","replace","currentYear","getFullYear","birthYear","birthDate","today","monthDiff","getMonth","getDate","Math","max","country","residenceMap","policyMap","packageMap","titleMap","currencyMap"],"sources":["C:/Users/laptop-123/TravelInsurance_Demo_2/src/services/terracottaService.ts"],"sourcesContent":["/**\n * Terracotta Insurance Quote Integration Service\n * \n * This service handles all communication with the Terracotta Integrated Quote web service\n * using SOAP protocol. It provides methods for:\n * - Requesting quotes (ProvideQuotation)\n * - Updating quotes with additional covers (ProvideQuotationWithAlterations)\n * - Getting screening questions (ScreeningQuestions)\n * - Saving policy details (SavePolicyDetails)\n */\n\n// Terracotta API Configuration\nconst TERRACOTTA_BASE_URL = 'https://www.asuaonline.com/ws/integratedquote.asmx';\nconst TERRACOTTA_USER_ID = '4072';\nconst TERRACOTTA_USER_CODE = '111427';\n\n// TypeScript interfaces for Terracotta API data structures\n\nexport interface TerracottaTraveler {\n  TravellerNumber: number;\n  Title: string;\n  FirstName: string;\n  LastName: string;\n  DateOfBirth: string; // Format: YYYY/MM/DD\n  Age: number;\n  AgebandID?: number;\n  TitleID?: number;\n  minAge?: number;\n  maxAge?: number;\n  AlterationID?: string;\n  msPrice?: number;\n  msPriceExcIPT?: number;\n  msConditions?: string;\n  ScreeningInformation?: any;\n}\n\nexport interface TerracottaContactDetails {\n  Address: string;\n  Postcode: string;\n  Email: string;\n  Telephone: string;\n  VehicleMakeModel?: string;\n  VehicleLicensePlate?: string;\n  VehicleYearManufacture?: string;\n}\n\nexport interface TerracottaQuoteDetails {\n  ResidenceID: string;\n  TypePolicyID: string; // Comma-separated list of policy type IDs\n  TypePackageID: string;\n  Destination: string;\n  StartDate: string; // Format: YYYY/MM/DD\n  EndDate: string; // Format: YYYY/MM/DD\n  Travellers: TerracottaTraveler[];\n  ContactDetails: TerracottaContactDetails;\n  includeAnnualQuotes?: number;\n  includeUpsell?: number;\n  alterionGenericID?: string;\n  voucherCode?: string;\n  isCYTI?: boolean;\n  currencyID?: number;\n  groupPerProduct?: boolean;\n  priceOrder?: number;\n  schemaIDFilter?: string;\n  useCoverLevelUpsell?: boolean;\n  sellOnBehalfOf?: number;\n  customerUniqueID?: number;\n  quoteVisitAuditID?: number;\n}\n\nexport interface TerracottaQuoteRequest {\n  userID: string;\n  userCode: string;\n  quoteDetails: TerracottaQuoteDetails;\n}\n\nexport interface TerracottaQuoteResult {\n  QuoteID: string;\n  schemaName: string;\n  policyTypeName: string;\n  SI: string; // Summary of cover PDF URL\n  PW: string; // Policy wording PDF URL\n  Currency: string;\n  IPT: number; // IPT amount\n  GrossPrice: number; // Quote price\n}\n\nexport interface TerracottaQuoteResponse {\n  Message: string;\n  quoteResults: TerracottaQuoteResult[];\n}\n\nexport interface TerracottaScreeningQuestionAnswer {\n  questionNumber: number;\n  answer: 'yes' | 'no';\n}\n\nexport interface TerracottaSavePolicyRequest {\n  userID: string;\n  userCode: string;\n  quoteID: string;\n  screeningQuestionAnswers: TerracottaScreeningQuestionAnswer[];\n  medicalScreeningReference?: string;\n}\n\nexport interface TerracottaSavePolicyResponse {\n  Message: string;\n  policySaved: 'Yes' | 'No';\n  policyID: string;\n  certificate: string; // URL for policy certificate\n  PW: string; // Policy wording PDF URL\n  SI: string; // Summary of cover PDF URL\n}\n\nexport interface TerracottaScreeningQuestion {\n  questionNumber: number;\n  question: string;\n  yesMessage: string;\n  noMessage: string;\n  yesAction: string;\n  noAction: string;\n  yesActionText: string;\n  noActionText: string;\n}\n\nexport interface TerracottaScreeningQuestionsResponse {\n  Message: string;\n  screeningQuestions: TerracottaScreeningQuestion[];\n}\n\nexport interface TerracottaProduct {\n  SchemaID: number;\n  SchemaName: string;\n}\n\nexport interface TerracottaProductListResponse {\n  Message: string;\n  ResultID: number;\n  Schemas: TerracottaProduct[];\n}\n\n/**\n * SOAP XML Builder utility functions\n */\nclass SOAPBuilder {\n  static createEnvelope(body: string): string {\n    return `<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" \n               xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" \n               xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\">\n  <soap:Body>\n    ${body}\n  </soap:Body>\n</soap:Envelope>`;\n  }\n\n  static buildTravelerXML(traveler: TerracottaTraveler): string {\n    return `\n      <Travellers>\n        <TravellerNumber>${traveler.TravellerNumber}</TravellerNumber>\n        <Title>${traveler.Title}</Title>\n        <FirstName>${traveler.FirstName}</FirstName>\n        <LastName>${traveler.LastName}</LastName>\n        <DateOfBirth>${traveler.DateOfBirth}</DateOfBirth>\n        <Age>${traveler.Age}</Age>\n        ${traveler.AgebandID ? `<AgebandID>${traveler.AgebandID}</AgebandID>` : ''}\n        ${traveler.TitleID ? `<TitleID>${traveler.TitleID}</TitleID>` : ''}\n        ${traveler.minAge ? `<minAge>${traveler.minAge}</minAge>` : ''}\n        ${traveler.maxAge ? `<maxAge>${traveler.maxAge}</maxAge>` : ''}\n        ${traveler.AlterationID ? `<AlterationID>${traveler.AlterationID}</AlterationID>` : ''}\n        ${traveler.msPrice ? `<msPrice>${traveler.msPrice}</msPrice>` : ''}\n        ${traveler.msPriceExcIPT ? `<msPriceExcIPT>${traveler.msPriceExcIPT}</msPriceExcIPT>` : ''}\n        ${traveler.msConditions ? `<msConditions>${traveler.msConditions}</msConditions>` : ''}\n        ${traveler.ScreeningInformation ? `<ScreeningInformation>${traveler.ScreeningInformation}</ScreeningInformation>` : '<ScreeningInformation xsi:nil=\"true\" />'}\n      </Travellers>`;\n  }\n\n  static buildContactDetailsXML(contact: TerracottaContactDetails): string {\n    return `\n      <ContactDetails>\n        <Address>${contact.Address}</Address>\n        <Postcode>${contact.Postcode}</Postcode>\n        <Email>${contact.Email}</Email>\n        <Telephone>${contact.Telephone}</Telephone>\n        ${contact.VehicleMakeModel ? `<VehicleMakeModel>${contact.VehicleMakeModel}</VehicleMakeModel>` : ''}\n        ${contact.VehicleLicensePlate ? `<VehicleLicensePlate>${contact.VehicleLicensePlate}</VehicleLicensePlate>` : ''}\n        ${contact.VehicleYearManufacture ? `<VehicleYearManufacture>${contact.VehicleYearManufacture}</VehicleYearManufacture>` : ''}\n      </ContactDetails>`;\n  }\n\n  static buildQuoteDetailsXML(details: TerracottaQuoteDetails): string {\n    const travelersXML = details.Travellers.map(traveler => \n      this.buildTravelerXML(traveler)\n    ).join('');\n\n    const contactXML = this.buildContactDetailsXML(details.ContactDetails);\n\n    return `\n      <quoteDetails>\n        <ResidenceID>${parseInt(details.ResidenceID) || 1}</ResidenceID>\n        <TypePolicyID>${details.TypePolicyID}</TypePolicyID>\n        <TypePackageID>${parseInt(details.TypePackageID) || 1}</TypePackageID>\n        <Destination>${details.Destination}</Destination>\n        <StartDate>${details.StartDate}</StartDate>\n        <EndDate>${details.EndDate}</EndDate>\n        ${travelersXML}\n        ${contactXML}\n        ${details.includeAnnualQuotes !== undefined ? `<includeAnnualQuotes>${details.includeAnnualQuotes}</includeAnnualQuotes>` : ''}\n        ${details.includeUpsell !== undefined ? `<includeUpsell>${details.includeUpsell}</includeUpsell>` : ''}\n        ${details.alterionGenericID ? `<alterionGenericID>${details.alterionGenericID}</alterionGenericID>` : ''}\n        ${details.voucherCode ? `<voucherCode>${details.voucherCode}</voucherCode>` : ''}\n        ${details.isCYTI !== undefined ? `<isCYTI>${details.isCYTI}</isCYTI>` : ''}\n        ${details.currencyID ? `<currencyID>${details.currencyID}</currencyID>` : ''}\n        ${details.groupPerProduct !== undefined ? `<groupPerProduct>${details.groupPerProduct}</groupPerProduct>` : ''}\n        ${details.priceOrder ? `<priceOrder>${details.priceOrder}</priceOrder>` : ''}\n        ${details.schemaIDFilter ? `<schemaIDFilter>${details.schemaIDFilter}</schemaIDFilter>` : ''}\n        ${details.useCoverLevelUpsell !== undefined ? `<useCoverLevelUpsell>${details.useCoverLevelUpsell}</useCoverLevelUpsell>` : ''}\n        ${details.sellOnBehalfOf ? `<sellOnBehalfOf>${details.sellOnBehalfOf}</sellOnBehalfOf>` : ''}\n        ${details.customerUniqueID ? `<customerUniqueID>${details.customerUniqueID}</customerUniqueID>` : ''}\n        ${details.quoteVisitAuditID ? `<quoteVisitAuditID>${details.quoteVisitAuditID}</quoteVisitAuditID>` : ''}\n      </quoteDetails>`;\n  }\n\n  static buildScreeningAnswersXML(answers: TerracottaScreeningQuestionAnswer[]): string {\n    return '<screeningQuestionAnswers>' + \n      answers.map(answer => `\n        <screeningQuestionAnswer>\n          <questionNumber>${answer.questionNumber}</questionNumber>\n          <answer>${answer.answer}</answer>\n        </screeningQuestionAnswer>`\n      ).join('') + '</screeningQuestionAnswers>';\n  }\n}\n\n/**\n * XML Parser utility functions\n */\nclass XMLParser {\n  static parseQuoteResponse(xmlText: string): TerracottaQuoteResponse {\n    try {\n      const parser = new DOMParser();\n      const xmlDoc = parser.parseFromString(xmlText, 'text/xml');\n      \n      // Check for parsing errors\n      const parseError = xmlDoc.querySelector('parsererror');\n      if (parseError) {\n        throw new Error(`XML parsing error: ${parseError.textContent}`);\n      }\n\n      const message = xmlDoc.querySelector('Message')?.textContent || '';\n      const quoteResults: TerracottaQuoteResult[] = [];\n\n      const quoteResultNodes = xmlDoc.querySelectorAll('quoteResults');\n      quoteResultNodes.forEach(node => {\n        const result: TerracottaQuoteResult = {\n          QuoteID: node.querySelector('QuoteID')?.textContent || '',\n          schemaName: node.querySelector('schemaName')?.textContent || '',\n          policyTypeName: node.querySelector('policyTypeName')?.textContent || '',\n          SI: node.querySelector('SI')?.textContent || '',\n          PW: node.querySelector('PW')?.textContent || '',\n          Currency: node.querySelector('Currency')?.textContent || '',\n          IPT: parseFloat(node.querySelector('IPT')?.textContent || '0'),\n          GrossPrice: parseFloat(node.querySelector('GrossPrice')?.textContent || '0')\n        };\n        quoteResults.push(result);\n      });\n\n      return { Message: message, quoteResults };\n    } catch (error) {\n      console.error('Error parsing quote response:', error);\n      throw new Error(`Failed to parse quote response: ${error instanceof Error ? error.message : 'Unknown error'}`);\n    }\n  }\n\n  static parseScreeningQuestionsResponse(xmlText: string): TerracottaScreeningQuestionsResponse {\n    try {\n      const parser = new DOMParser();\n      const xmlDoc = parser.parseFromString(xmlText, 'text/xml');\n      \n      const parseError = xmlDoc.querySelector('parsererror');\n      if (parseError) {\n        throw new Error(`XML parsing error: ${parseError.textContent}`);\n      }\n\n      const message = xmlDoc.querySelector('Message')?.textContent || '';\n      const screeningQuestions: TerracottaScreeningQuestion[] = [];\n\n      const questionNodes = xmlDoc.querySelectorAll('screeningQuestion');\n      questionNodes.forEach(node => {\n        const question: TerracottaScreeningQuestion = {\n          questionNumber: parseInt(node.querySelector('questionNumber')?.textContent || '0'),\n          question: node.querySelector('question')?.textContent || '',\n          yesMessage: node.querySelector('yesMessage')?.textContent || '',\n          noMessage: node.querySelector('noMessage')?.textContent || '',\n          yesAction: node.querySelector('yesAction')?.textContent || '',\n          noAction: node.querySelector('noAction')?.textContent || '',\n          yesActionText: node.querySelector('yesActionText')?.textContent || '',\n          noActionText: node.querySelector('noActionText')?.textContent || ''\n        };\n        screeningQuestions.push(question);\n      });\n\n      return { Message: message, screeningQuestions };\n    } catch (error) {\n      console.error('Error parsing screening questions response:', error);\n      throw new Error(`Failed to parse screening questions response: ${error instanceof Error ? error.message : 'Unknown error'}`);\n    }\n  }\n\n  static parseSavePolicyResponse(xmlText: string): TerracottaSavePolicyResponse {\n    try {\n      const parser = new DOMParser();\n      const xmlDoc = parser.parseFromString(xmlText, 'text/xml');\n      \n      const parseError = xmlDoc.querySelector('parsererror');\n      if (parseError) {\n        throw new Error(`XML parsing error: ${parseError.textContent}`);\n      }\n\n      return {\n        Message: xmlDoc.querySelector('Message')?.textContent || '',\n        policySaved: xmlDoc.querySelector('policySaved')?.textContent as 'Yes' | 'No' || 'No',\n        policyID: xmlDoc.querySelector('policyID')?.textContent || '',\n        certificate: xmlDoc.querySelector('certificate')?.textContent || '',\n        PW: xmlDoc.querySelector('PW')?.textContent || '',\n        SI: xmlDoc.querySelector('SI')?.textContent || ''\n      };\n    } catch (error) {\n      console.error('Error parsing save policy response:', error);\n      throw new Error(`Failed to parse save policy response: ${error instanceof Error ? error.message : 'Unknown error'}`);\n    }\n  }\n\n  static parseProductListResponse(xmlText: string): TerracottaProductListResponse {\n    try {\n      const parser = new DOMParser();\n      const xmlDoc = parser.parseFromString(xmlText, 'text/xml');\n      \n      const parseError = xmlDoc.querySelector('parsererror');\n      if (parseError) {\n        throw new Error(`XML parsing error: ${parseError.textContent}`);\n      }\n\n      const message = xmlDoc.querySelector('message')?.textContent || '';\n      const resultID = parseInt(xmlDoc.querySelector('errorID')?.textContent || '0');\n      const schemas: TerracottaProduct[] = [];\n\n      const schemaNodes = xmlDoc.querySelectorAll('Schema');\n      schemaNodes.forEach(node => {\n        const schema: TerracottaProduct = {\n          SchemaID: parseInt(node.querySelector('SchemaID')?.textContent || '0'),\n          SchemaName: node.querySelector('SchemaName')?.textContent || ''\n        };\n        schemas.push(schema);\n      });\n\n      return { Message: message, ResultID: resultID, Schemas: schemas };\n    } catch (error) {\n      console.error('Error parsing product list response:', error);\n      throw new Error(`Failed to parse product list response: ${error instanceof Error ? error.message : 'Unknown error'}`);\n    }\n  }\n}\n\n/**\n * Main Terracotta Service Class\n */\nexport class TerracottaService {\n  private static instance: TerracottaService;\n  private userID: string;\n  private userCode: string;\n\n  constructor(userID: string = TERRACOTTA_USER_ID, userCode: string = TERRACOTTA_USER_CODE) {\n    this.userID = userID;\n    this.userCode = userCode;\n  }\n\n  static getInstance(userID?: string, userCode?: string): TerracottaService {\n    if (!TerracottaService.instance) {\n      TerracottaService.instance = new TerracottaService(userID, userCode);\n    }\n    return TerracottaService.instance;\n  }\n\n  /**\n   * Generic SOAP request method\n   */\n  private async makeSOAPRequest(method: string, requestBody: string): Promise<string> {\n    const soapEnvelope = SOAPBuilder.createEnvelope(requestBody);\n    \n    console.log('Making SOAP request to:', TERRACOTTA_BASE_URL);\n    console.log('SOAP Envelope:', soapEnvelope);\n    \n      const response = await fetch(TERRACOTTA_BASE_URL, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'text/xml; charset=utf-8',\n        'SOAPAction': `WS-IntegratedQuote/${method}`\n      },\n      body: soapEnvelope\n    });\n\n    console.log('SOAP Response Status:', response.status, response.statusText);\n    const responseText = await response.text();\n    console.log('SOAP Response Body:', responseText);\n\n    if (!response.ok) {\n      throw new Error(`SOAP request failed: ${response.status} ${response.statusText}`);\n    }\n\n    return responseText;\n  }\n\n  /**\n   * Test connection with HelloWorld method\n   */\n  async testConnection(): Promise<boolean> {\n    try {\n      const soapBody = `\n        <HelloWorld xmlns=\"WS-IntegratedQuote\">\n        </HelloWorld>`;\n\n      const responseText = await this.makeSOAPRequest('HelloWorld', soapBody);\n      console.log('Connection test successful:', responseText);\n      return true;\n    } catch (error) {\n      console.error('Connection test failed:', error);\n      return false;\n    }\n  }\n\n  /**\n   * Get available products for the user\n   */\n  async getUserProductList(): Promise<TerracottaProductListResponse> {\n    try {\n      const soapBody = `\n        <GetUserProductList xmlns=\"WS-IntegratedQuote\">\n          <userID>${parseInt(this.userID)}</userID>\n          <userCode>${parseInt(this.userCode)}</userCode>\n        </GetUserProductList>`;\n\n      const responseText = await this.makeSOAPRequest('GetUserProductList', soapBody);\n      return XMLParser.parseProductListResponse(responseText);\n    } catch (error) {\n      console.error('Error in getUserProductList:', error);\n      throw new Error(`Failed to get user product list: ${error instanceof Error ? error.message : 'Unknown error'}`);\n    }\n  }\n\n  /**\n   * 1. Request for quotations\n   * Calls the ProvideQuotation method to obtain a list of possible quotes\n   */\n  async provideQuotation(request: TerracottaQuoteRequest): Promise<TerracottaQuoteResponse> {\n    try {\n      const quoteDetailsXML = SOAPBuilder.buildQuoteDetailsXML(request.quoteDetails);\n      \n      const soapBody = `\n        <ProvideQuotation xmlns=\"WS-IntegratedQuote\">\n          <userID>${parseInt(request.userID)}</userID>\n          <userCode>${parseInt(request.userCode)}</userCode>\n          ${quoteDetailsXML}\n        </ProvideQuotation>`;\n\n      const responseText = await this.makeSOAPRequest('ProvideQuotation', soapBody);\n      return XMLParser.parseQuoteResponse(responseText);\n    } catch (error) {\n      console.error('Error in provideQuotation:', error);\n      throw new Error(`Failed to get quotes from Terracotta: ${error instanceof Error ? error.message : 'Unknown error'}`);\n    }\n  }\n\n  /**\n   * 3. Obtain Screening Questions\n   * Calls ScreeningQuestions to get screening questions for the selected quote\n   */\n  async getScreeningQuestions(quoteID: string): Promise<TerracottaScreeningQuestionsResponse> {\n    try {\n      const soapBody = `\n        <ScreeningQuestions xmlns=\"WS-IntegratedQuote\">\n          <userID>${parseInt(this.userID)}</userID>\n          <userCode>${parseInt(this.userCode)}</userCode>\n          <quoteID>${quoteID}</quoteID>\n        </ScreeningQuestions>`;\n\n      const responseText = await this.makeSOAPRequest('ScreeningQuestions', soapBody);\n      return XMLParser.parseScreeningQuestionsResponse(responseText);\n    } catch (error) {\n      console.error('Error in getScreeningQuestions:', error);\n      throw new Error(`Failed to get screening questions: ${error instanceof Error ? error.message : 'Unknown error'}`);\n    }\n  }\n\n  /**\n   * 4. Save a quote as a Live policy\n   * Calls SavePolicyDetails to convert the quote into a live policy\n   */\n  async savePolicyDetails(request: TerracottaSavePolicyRequest): Promise<TerracottaSavePolicyResponse> {\n    try {\n      const screeningAnswersXML = SOAPBuilder.buildScreeningAnswersXML(request.screeningQuestionAnswers);\n      \n      const soapBody = `\n        <SavePolicyDetails xmlns=\"WS-IntegratedQuote\">\n          <userID>${parseInt(request.userID)}</userID>\n          <userCode>${parseInt(request.userCode)}</userCode>\n          <quoteID>${request.quoteID}</quoteID>\n          ${screeningAnswersXML}\n          ${request.medicalScreeningReference ? `<medicalScreeningReference>${request.medicalScreeningReference}</medicalScreeningReference>` : ''}\n        </SavePolicyDetails>`;\n\n      const responseText = await this.makeSOAPRequest('SavePolicyDetails', soapBody);\n      return XMLParser.parseSavePolicyResponse(responseText);\n    } catch (error) {\n      console.error('Error in savePolicyDetails:', error);\n      throw new Error(`Failed to save policy details: ${error instanceof Error ? error.message : 'Unknown error'}`);\n    }\n  }\n\n  /**\n   * Utility method to convert frontend data to Terracotta format\n   */\n  static convertToTerracottaFormat(formData: any): TerracottaQuoteRequest {\n    console.log('Converting form data to Terracotta format:', formData);\n    \n    // Convert travelers to Terracotta format using actual user data\n    const travelers: TerracottaTraveler[] = formData.travelers.map((traveler: any, index: number) => {\n      // Prioritize date of birth over age for accuracy\n      const dateOfBirth = traveler.dateOfBirth || calculateDateOfBirth(parseInt(traveler.age));\n      const calculatedAge = traveler.dateOfBirth ? \n        calculateAgeFromDateOfBirth(traveler.dateOfBirth) : \n        parseInt(traveler.age);\n      \n      console.log(`Traveler ${index + 1}: DOB=${dateOfBirth}, Age=${calculatedAge}`);\n      \n      return {\n        TravellerNumber: index + 1,\n        Title: traveler.title || 'Mr', // Use actual title from form\n        FirstName: traveler.firstName,\n        LastName: traveler.lastName,\n        DateOfBirth: formatDateForTerracotta(dateOfBirth),\n        Age: calculatedAge,\n        AgebandID: getAgebandID(calculatedAge),\n        TitleID: getTitleID(traveler.title || 'Mr'),\n        minAge: calculatedAge,\n        maxAge: calculatedAge,\n        ScreeningInformation: null\n      };\n    });\n\n    // Convert contact details using actual user data\n    const contactDetails: TerracottaContactDetails = {\n      Address: formData.billingAddress?.street || formData.contactAddress?.street || '123 Main Street',\n      Postcode: formData.billingAddress?.postalCode || formData.contactAddress?.postalCode || '12345',\n      Email: formData.travelers[0]?.email || formData.contactEmail || 'test@example.com',\n      Telephone: formData.travelers[0]?.phone || formData.contactPhone || '+30123456789',\n      VehicleMakeModel: formData.vehicleMakeModel,\n      VehicleLicensePlate: formData.vehicleLicensePlate,\n      VehicleYearManufacture: formData.vehicleYearManufacture\n    };\n\n           // Convert trip details using actual user data\n           const quoteDetails: TerracottaQuoteDetails = {\n             ResidenceID: getResidenceID(formData.countryOfResidence),\n             TypePolicyID: getTypePolicyID(formData.tripType),\n             TypePackageID: getTypePackageID(formData.tripType),\n             Destination: formData.destination || 'Europe',\n             StartDate: formatDateForTerracotta(formData.startDate),\n             EndDate: formatDateForTerracotta(formData.endDate),\n             Travellers: travelers,\n             ContactDetails: contactDetails,\n             includeAnnualQuotes: formData.tripType === 'annual' ? 1 : 0,\n             includeUpsell: 1, // Include upsell options\n             voucherCode: formData.voucherCode,\n             currencyID: getCurrencyID(formData.currency || 'EUR'),\n             groupPerProduct: false,\n             priceOrder: 1, // Sort by price ascending\n             useCoverLevelUpsell: true,\n             customerUniqueID: formData.customerId ? parseInt(formData.customerId) : undefined,\n             quoteVisitAuditID: Date.now(), // Use timestamp as audit ID\n             schemaIDFilter: '683,717' // Use your available SchemaIDs\n           };\n\n    console.log('Converted Terracotta request:', quoteDetails);\n    \n    return {\n      userID: TERRACOTTA_USER_ID,\n      userCode: TERRACOTTA_USER_CODE,\n      quoteDetails\n    };\n  }\n}\n\n/**\n * Utility functions for data conversion\n */\n\nfunction formatDateForTerracotta(dateString: string): string {\n  if (!dateString) return '';\n  // Convert from YYYY-MM-DD to YYYY/MM/DD\n  return dateString.replace(/-/g, '/');\n}\n\nfunction calculateDateOfBirth(age: number): string {\n  const currentYear = new Date().getFullYear();\n  const birthYear = currentYear - age;\n  // Use January 1st as default date\n  return `${birthYear}/01/01`;\n}\n\nfunction calculateAgeFromDateOfBirth(dateOfBirth: string): number {\n  const birthDate = new Date(dateOfBirth);\n  const today = new Date();\n  let age = today.getFullYear() - birthDate.getFullYear();\n  const monthDiff = today.getMonth() - birthDate.getMonth();\n  \n  if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthDate.getDate())) {\n    age--;\n  }\n  \n  return Math.max(0, age);\n}\n\nfunction getResidenceID(country: string): string {\n  // Map countries to Terracotta Residence IDs\n  // Based on your account, we'll use numeric IDs that should work\n  const residenceMap: { [key: string]: string } = {\n    'Greece': '1',      // Default for Greece\n    'Germany': '2',\n    'United Kingdom': '3',\n    'France': '4',\n    'Italy': '5',\n    'Spain': '6',\n    'Netherlands': '7',\n    'Belgium': '8',\n    'Austria': '9',\n    'Switzerland': '10',\n    'United States': '11',\n    'Canada': '12',\n    'Australia': '13'\n  };\n  \n  return residenceMap[country] || '1'; // Default to 1\n}\n\nfunction getTypePolicyID(tripType: string): string {\n  // Use your available SchemaIDs for policy types\n  // SchemaID 683: \"Already Travelling Travel Insurance 2023-2024\"\n  // SchemaID 717: \"KTRM Travel Insurance 2025\"\n  const policyMap: { [key: string]: string } = {\n    'single': '683',      // Use your available SchemaID\n    'annual': '717',      // Use your other available SchemaID\n    'comprehensive': '683' // Use available SchemaID\n  };\n  \n  return policyMap[tripType] || '683'; // Default to your first SchemaID\n}\n\nfunction getTypePackageID(tripType: string): string {\n  // Use your available SchemaIDs for package types\n  const packageMap: { [key: string]: string } = {\n    'single': '683',      // Use your available SchemaID\n    'annual': '717',      // Use your other available SchemaID\n    'comprehensive': '683' // Use available SchemaID\n  };\n  \n  return packageMap[tripType] || '683'; // Default to your first SchemaID\n}\n\nfunction getAgebandID(age: number): number {\n  // Map age to Terracotta Ageband ID\n  if (age <= 17) return 1;\n  if (age <= 30) return 2;\n  if (age <= 40) return 3;\n  if (age <= 50) return 4;\n  if (age <= 60) return 5;\n  if (age <= 70) return 6;\n  return 7; // 70+\n}\n\nfunction getTitleID(title: string): number {\n  // Map title to Terracotta Title ID\n  const titleMap: { [key: string]: number } = {\n    'Mr': 1,\n    'Mrs': 2,\n    'Miss': 3,\n    'Ms': 4,\n    'Dr': 5,\n    'Prof': 6\n  };\n  \n  return titleMap[title] || 1; // Default to Mr\n}\n\nfunction getCurrencyID(currency: string): number {\n  // Map currency to Terracotta Currency ID\n  const currencyMap: { [key: string]: number } = {\n    'EUR': 1,\n    'USD': 2,\n    'GBP': 3,\n    'CHF': 4\n  };\n  \n  return currencyMap[currency] || 1; // Default to EUR\n}\n\nexport default TerracottaService;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}